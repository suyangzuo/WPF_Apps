<Window
    x:Class="WPF_Typing.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:WPF_Typing"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:wc="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    Title="æ‰“å­—ç»ƒä¹ "
    Width="800"
    Height="600"
    MinWidth="1000"
    MinHeight="600"
    AllowsTransparency="True"
    Background="Transparent"
    FontFamily="{DynamicResource AppFontFamily}"
    Foreground="#FFFFFF"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d">

    <Window.Resources>
        <!--  Window drop shadow used for custom chrome window  -->
        <DropShadowEffect
            x:Key="WindowDropShadow"
            BlurRadius="30"
            Opacity="0.6"
            RenderingBias="Quality"
            ShadowDepth="0"
            Color="#000000" />

        <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#1A1A1A" />
        <SolidColorBrush x:Key="WindowTextBrush" Color="#FFFFFF" />

        <!--  Menu horizontal inner padding (left,right)  -->
        <Thickness x:Key="MenuInnerPadding">8, 0</Thickness>

        <!--  èœå•æ èƒŒæ™¯è‰²  -->
        <SolidColorBrush x:Key="MenuBackgroundBrush" Color="#1A1A1A" />

        <!--  Menu-only font family (force Microsoft YaHei)  -->
        <FontFamily x:Key="MenuFontFamily">Google Sans Code, Consolas, HarmonyOS Sans SC, å¾®è½¯é›…é»‘</FontFamily>

        <!--  Shared application font family (kept for other controls if needed)  -->
        <FontFamily x:Key="AppFontFamily">Google Sans Code, Consolas, HarmonyOS Sans SC, å¾®è½¯é›…é»‘</FontFamily>

        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="{StaticResource AppFontFamily}" />
        </Style>

        <Style x:Key="WindowButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="Border"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Transparent">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#555" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#777" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CloseButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="Border"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Transparent"
                            CornerRadius="0,10,0,0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#E81123" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  æ’­æ”¾æŒ‰é’®æ ·å¼ï¼ˆç»¿è‰²ï¼‰  -->
        <Style x:Key="PlayButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#228D42" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="Border"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="{TemplateBinding Background}"
                            CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="#329D52" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Border" Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="#1A7A32" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  åœæ­¢æŒ‰é’®æ ·å¼ï¼ˆçº¢è‰²ï¼‰  -->
        <Style x:Key="StopButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#8C142C" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="Border"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="{TemplateBinding Background}"
                            CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="#BD101C" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Border" Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="#B01030" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DarkMenuItemStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="#1A1A1A" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="32" />
            <!--  force menu font family  -->
            <Setter Property="FontFamily" Value="{StaticResource MenuFontFamily}" />
            <!--  ä¸€çº§èœå•å­—ä½“å¤§å°ï¼ˆåªå½±å“é¡¶å±‚èœå•é¡¹ï¼‰  -->
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border
                            x:Name="Border"
                            Height="30"
                            Background="#1A1A1A"
                            BorderBrush="Transparent"
                            BorderThickness="1">
                            <Grid>
                                <ContentPresenter
                                    x:Name="HeaderHost"
                                    Margin="12,0"
                                    VerticalAlignment="Center"
                                    ContentSource="Header" />
                                <Popup
                                    x:Name="SubMenuPopup"
                                    AllowsTransparency="True"
                                    HorizontalOffset="-4"
                                    IsOpen="{TemplateBinding IsSubmenuOpen}"
                                    Placement="Bottom"
                                    VerticalOffset="6">
                                    <!--  Keep a single outer border for the submenu panel with rounded corners  -->
                                    <Border
                                        x:Name="SubMenuBorder"
                                        Padding="4"
                                        Background="#2D2D2D"
                                        BorderBrush="Transparent"
                                        BorderThickness="0"
                                        CornerRadius="4">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#135" />
                                <Setter TargetName="Border" Property="BorderBrush" Value="#2DB" />
                                <Setter TargetName="Border" Property="BorderThickness" Value="1" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Submenu items: remove per-item borders so parent SubMenuBorder provides the overall border  -->
        <Style x:Key="DarkSubMenuItemStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="#2D2D2D" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="30" />
            <Setter Property="FontFamily" Value="{StaticResource MenuFontFamily}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border
                            x:Name="Border"
                            Height="30"
                            Background="{TemplateBinding Background}"
                            BorderBrush="Transparent"
                            BorderThickness="0">
                            <Grid>
                                <ContentPresenter
                                    x:Name="HeaderHost"
                                    Margin="8,0"
                                    VerticalAlignment="Center"
                                    ContentSource="Header" />
                                <Popup
                                    x:Name="SubMenuPopup"
                                    AllowsTransparency="True"
                                    HorizontalOffset="8"
                                    IsOpen="{TemplateBinding IsSubmenuOpen}"
                                    Placement="Right"
                                    VerticalOffset="-4">
                                    <!--  For nested submenus keep their own panel border with rounded corners  -->
                                    <Border
                                        x:Name="SubMenuBorder"
                                        Padding="8"
                                        Background="#2D2D2D"
                                        BorderBrush="#2D2D2D"
                                        BorderThickness="1"
                                        CornerRadius="6">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#404A60" />
                                <!--  do not show per-item border on highlight  -->
                                <Setter TargetName="Border" Property="BorderBrush" Value="Transparent" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Checkable submenu items: also remove per-item borders  -->
        <Style x:Key="CheckableSubMenuItemStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="#2D2D2D" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="30" />
            <Setter Property="FontFamily" Value="{StaticResource MenuFontFamily}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border
                            x:Name="Border"
                            Height="30"
                            Background="#2D2D2D"
                            BorderBrush="Transparent"
                            BorderThickness="0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Border
                                    x:Name="CheckMarkBox"
                                    Grid.Column="0"
                                    Width="14"
                                    Height="14"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    Background="Transparent"
                                    BorderBrush="Gray"
                                    BorderThickness="1">
                                    <TextBlock
                                        x:Name="CheckMark"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontSize="10"
                                        Foreground="White"
                                        Text="âœ“"
                                        Visibility="Collapsed" />
                                </Border>
                                <ContentPresenter
                                    x:Name="HeaderHost"
                                    Grid.Column="1"
                                    Margin="10,0"
                                    VerticalAlignment="Center"
                                    ContentSource="Header" />
                                <Popup
                                    x:Name="SubMenuPopup"
                                    AllowsTransparency="True"
                                    HorizontalOffset="8"
                                    IsOpen="{TemplateBinding IsSubmenuOpen}"
                                    Placement="Right"
                                    VerticalOffset="-4">
                                    <Border
                                        x:Name="SubMenuBorder"
                                        Padding="4"
                                        Background="#2D2D2D"
                                        BorderBrush="#2D2D2D"
                                        BorderThickness="1"
                                        CornerRadius="6">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#345" />
                                <Setter TargetName="Border" Property="BorderBrush" Value="Transparent" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SubMenuHeaderStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="30" />
            <Setter Property="FontFamily" Value="{StaticResource MenuFontFamily}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border
                            x:Name="Border"
                            Height="30"
                            Background="{TemplateBinding Background}"
                            BorderBrush="Transparent"
                            BorderThickness="0">
                            <Grid>
                                <ContentPresenter
                                    x:Name="HeaderHost"
                                    Margin="10,0"
                                    VerticalAlignment="Center"
                                    ContentSource="Header" />
                                <Popup
                                    x:Name="SubMenuPopup"
                                    AllowsTransparency="True"
                                    HorizontalOffset="8"
                                    IsOpen="{TemplateBinding IsSubmenuOpen}"
                                    Placement="Right">
                                    <Border
                                        x:Name="SubMenuBorder"
                                        Padding="4"
                                        Background="#2D2D2D"
                                        BorderBrush="#2D2D2D"
                                        BorderThickness="1"
                                        CornerRadius="6">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <!--  match hover background of other second-level menu items but keep no outer border  -->
                                <Setter TargetName="Border" Property="Background" Value="#404A60" />
                                <Setter TargetName="Border" Property="BorderBrush" Value="Transparent" />
                                <Setter TargetName="Border" Property="BorderThickness" Value="0" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="0"
            CornerRadius="10"
            GlassFrameThickness="0"
            ResizeBorderThickness="5"
            UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>

    <Border
        Background="#1A1A1A"
        BorderBrush="#555"
        BorderThickness="1"
        CornerRadius="10"
        Effect="{StaticResource WindowDropShadow}">
        <Grid>
            <Grid
                x:Name="TitleBarGrid"
                Height="36"
                VerticalAlignment="Top"
                Panel.ZIndex="10"
                MouseLeftButtonDown="WindowTitleBar_MouseLeftButtonDown"
                MouseLeftButtonUp="WindowTitleBar_MouseLeftButtonUp"
                MouseMove="WindowTitleBar_MouseMove">
                <Border Background="#2D2D2D" CornerRadius="10,10,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Image
                            Grid.Column="0"
                            Width="20"
                            Height="20"
                            Margin="8,0,8,0"
                            VerticalAlignment="Center"
                            SnapsToDevicePixels="True"
                            Source="pack://siteoforigin:,,,/Assets/Images/PNG/åæŒ‡ç¦….png"
                            Stretch="Uniform" />

                        <!--  Buttons remain in right column  -->
                        <StackPanel
                            Grid.Column="2"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Panel.ZIndex="10"
                            Orientation="Horizontal">
                            <Button
                                x:Name="MinimizeButton"
                                Width="45"
                                Height="36"
                                Click="MinimizeButton_Click"
                                Content="â€“"
                                Focusable="True"
                                FontSize="16"
                                Style="{StaticResource WindowButtonStyle}" />
                            <Button
                                x:Name="MaximizeButton"
                                Width="45"
                                Height="36"
                                Click="MaximizeButton_Click"
                                Content="â–¢"
                                Focusable="True"
                                FontSize="16"
                                Style="{StaticResource WindowButtonStyle}" />
                            <Button
                                x:Name="CloseButton"
                                Width="45"
                                Height="36"
                                Click="CloseButton_Click"
                                Content="âœ•"
                                Focusable="True"
                                FontSize="16"
                                Style="{StaticResource CloseButtonStyle}" />
                        </StackPanel>

                        <!--  overlayed centered title so it's visually centered for the whole title bar  -->
                        <TextBlock
                            x:Name="TitleText"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Panel.ZIndex="20"
                            FontSize="14"
                            Foreground="#CCC"
                            IsHitTestVisible="False"
                            Text="åæŒ‡ç¦…" />
                    </Grid>
                </Border>
            </Grid>

            <Menu
                Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=Window}}"
                Height="32"
                Margin="0,38,0,0"
                Padding="{StaticResource MenuInnerPadding}"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Top"
                Panel.ZIndex="0"
                Background="{StaticResource MenuBackgroundBrush}"
                BorderBrush="#10FFFFFF"
                BorderThickness="0,0,0,1"
                FontFamily="{StaticResource MenuFontFamily}"
                Foreground="White">
                <MenuItem Header="æ–‡ä»¶" Style="{StaticResource DarkMenuItemStyle}">
                    <MenuItem Click="ExitMenuItem_Click" Style="{StaticResource DarkSubMenuItemStyle}">
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,8,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="#FFA500"
                                    Text="ðŸšª" />
                                <TextBlock VerticalAlignment="Center" Text="é€€å‡º" />
                            </StackPanel>
                        </MenuItem.Header>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="è®¾ç½®" Style="{StaticResource DarkMenuItemStyle}">
                    <MenuItem Click="NameMenuItem_Click" Style="{StaticResource DarkSubMenuItemStyle}">
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,8,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="#4169E1"
                                    Text="ðŸ‘¤" />
                                <TextBlock VerticalAlignment="Center" Text="å§“å" />
                            </StackPanel>
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem Click="TimingMenuItem_Click" Style="{StaticResource DarkSubMenuItemStyle}">
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,8,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="#00CED1"
                                    Text="â±ï¸" />
                                <TextBlock VerticalAlignment="Center" Text="è®¡æ—¶" />
                            </StackPanel>
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem Click="AnalysisMenuItem_Click" Style="{StaticResource DarkSubMenuItemStyle}">
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,8,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="#32CD32"
                                    Text="ðŸ“Š" />
                                <TextBlock VerticalAlignment="Center" Text="ç»Ÿè®¡" />
                            </StackPanel>
                        </MenuItem.Header>
                    </MenuItem>
                </MenuItem>
                <MenuItem
                    x:Name="TextSelectionMenu"
                    Header="æ–‡æœ¬é€‰æ‹©"
                    Style="{StaticResource DarkMenuItemStyle}">
                    <!--  åŠ¨æ€å¡«å……  -->
                    <MenuItem
                        Header="(åŠ è½½ä¸­...)"
                        IsEnabled="False"
                        Style="{StaticResource DarkSubMenuItemStyle}" />
                </MenuItem>
                <MenuItem Header="å¸®åŠ©" Style="{StaticResource DarkMenuItemStyle}">
                    <MenuItem Click="HelpMenuItem_Click" Style="{StaticResource DarkSubMenuItemStyle}">
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,8,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="#FFD700"
                                    Text="â“" />
                                <TextBlock VerticalAlignment="Center" Text="ä½¿ç”¨è¯´æ˜Ž" />
                            </StackPanel>
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem Click="AboutMenuItem_Click" Style="{StaticResource DarkSubMenuItemStyle}">
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,8,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="#87CEEB"
                                    Text="â„¹ï¸" />
                                <TextBlock VerticalAlignment="Center" Text="å…³äºŽ" />
                            </StackPanel>
                        </MenuItem.Header>
                    </MenuItem>
                </MenuItem>
            </Menu>

            <Grid Margin="0,84,0,0">
                <!--  ä¸»å†…å®¹åŒº: å ä½, ç”¨æˆ·åŽç»­æ‰©å±•å†…å®¹  -->
                <!--  æ’­æ”¾/åœæ­¢æŒ‰é’® (å³ä¸Šè§’)  -->
                <Button
                    x:Name="PlayStopButton"
                    Width="30"
                    Height="30"
                    Margin="0,85,60,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Panel.ZIndex="30"
                    Click="PlayStopButton_Click"
                    FontSize="16"
                    Focusable="False"
                    Style="{StaticResource PlayButtonStyle}">
                    â–¶
                </Button>

                <Border
                    Margin="50,75,50,25"
                    Padding="50,0,50,0"
                    Background="#151515"
                    BorderThickness="2"
                    ClipToBounds="True"
                    CornerRadius="8">
                    <!--  Typing area: RichTextBox used to render per-character Runs so we can color them  -->
                    <!--  ä½¿ç”¨ ScrollViewer åŒ…è£¹ RichTextBoxï¼Œå®Œå…¨æŽ§åˆ¶æ»šåŠ¨è¡Œä¸º  -->
                    <ScrollViewer
                        x:Name="TypingDisplayScrollViewer"
                        HorizontalScrollBarVisibility="Disabled"
                        VerticalScrollBarVisibility="Hidden">
                        <RichTextBox
                            x:Name="TypingDisplay"
                            Height="Auto"
                            MaxWidth="1250"
                            HorizontalAlignment="Stretch"
                            AcceptsReturn="False"
                            AcceptsTab="False"
                            Background="#151515"
                            BorderThickness="0"
                            FontFamily="{StaticResource MenuFontFamily}"
                            FontSize="24"
                            Foreground="#777"
                            HorizontalScrollBarVisibility="Disabled"
                            IsDocumentEnabled="True"
                            IsReadOnly="True"
                            PreviewKeyDown="TypingDisplay_PreviewKeyDown"
                            PreviewTextInput="TypingDisplay_PreviewTextInput"
                            SnapsToDevicePixels="True"
                            TextOptions.TextFormattingMode="Display"
                            UseLayoutRounding="True">
                            <FlowDocument>
                                <Paragraph />
                            </FlowDocument>
                        </RichTextBox>
                    </ScrollViewer>
                </Border>

                <StackPanel
                    Width="Auto"
                    MaxWidth="1000"
                    Margin="25,25,25,0"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Top"
                    Panel.ZIndex="20"
                    IsHitTestVisible="False">
                    <!--  Tester name in top-right of main content area (below title/menu)  -->
                    <Grid
                        x:Name="TopRightInfoPanel"
                        Width="Auto"
                        MaxWidth="1000"
                        Margin="0,0,0,0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <!--  1) å·²è¾“å…¥å­—ç¬¦æ•° / æ€»å­—ç¬¦æ•° (label + numbers; label å’Œæ•°å­—ç”¨ä¸åŒé¢œè‰²)  -->
                        <TextBlock
                            Grid.Column="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontFamily="{StaticResource MenuFontFamily}"
                            FontSize="1">
                            <Run
                                FontSize="14"
                                Foreground="DarkGray"
                                Text="å·²è¾“å…¥" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":&#8202;" />
                            <Run
                                FontSize="14"
                                Foreground="#9DCBFF"
                                Text="{Binding TypedCount, Mode=OneWay, FallbackValue=0}" />
                            <Run
                                FontFamily="å¾®è½¯é›…é»‘"
                                FontSize="14"
                                Foreground="Gray"
                                Text="&#8202;/&#8202;" />
                            <Run
                                FontSize="14"
                                Foreground="#32CD32"
                                Text="{Binding TotalCount, Mode=OneWay, FallbackValue=0}" />
                        </TextBlock>

                        <!--  2) è¾“å…¥è¿›åº¦: (æ ‡ç­¾ + åªæ˜¾ç¤ºç™¾åˆ†æ¯”)  -->
                        <TextBlock
                            Grid.Column="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontFamily="{StaticResource MenuFontFamily}"
                            FontSize="1">
                            <Run
                                FontSize="14"
                                Foreground="DarkGray"
                                Text="è¿›åº¦" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":&#8202;" />
                            <Run
                                FontSize="14"
                                Foreground="#FFA500"
                                Text="{Binding ProgressPercent, Mode=OneWay, FallbackValue=0, StringFormat={}{0}}" />
                            <Run
                                FontFamily="HarmonyOS Sans SC, å¾®è½¯é›…é»‘"
                                FontSize="12"
                                Foreground="LightSlateGray"
                                Text="&#8202;%" />
                        </TextBlock>

                        <!--  3) æ­£ç¡®çŽ‡: (æ ‡ç­¾ + åªæ˜¾ç¤ºç™¾åˆ†æ¯”)  -->
                        <TextBlock
                            Grid.Column="2"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontFamily="{StaticResource MenuFontFamily}"
                            FontSize="1">
                            <Run
                                FontSize="14"
                                Foreground="DarkGray"
                                Text="æ­£ç¡®çŽ‡" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":&#8202;" />
                            <Run
                                FontSize="14"
                                Foreground="#FFD700"
                                Text="{Binding AccuracyPercent, Mode=OneWay, FallbackValue=0, StringFormat={}{0}}" />
                            <Run
                                FontFamily="HarmonyOS Sans SC, å¾®è½¯é›…é»‘"
                                FontSize="12"
                                Foreground="LightSlateGray"
                                Text="&#8202;%" />
                        </TextBlock>

                        <!--  4) é€Ÿåº¦: æ˜¾ç¤ºæ•°å­—å¹¶å¸¦å•ä½ (æ•°å­—ä¸Žå•ä½ç”¨ä¸åŒé¢œè‰²)  -->
                        <TextBlock
                            Grid.Column="3"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontFamily="{StaticResource MenuFontFamily}"
                            FontSize="1">
                            <Run
                                FontSize="14"
                                Foreground="DarkGray"
                                Text="é€Ÿåº¦" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":&#8202;" />
                            <Run
                                FontSize="14"
                                Foreground="GreenYellow"
                                Text="{Binding Speed, Mode=OneWay, FallbackValue=0, StringFormat={}{0:F0}}" />
                        </TextBlock>

                        <!--  5) å·²ç”¨æ—¶é—´: æ—¶:åˆ†:ç§’ (numbers and colons different colors)  -->
                        <TextBlock
                            Grid.Column="4"
                            HorizontalAlignment="Center"
                            FontFamily="{StaticResource MenuFontFamily}"
                            FontSize="1">
                            <Run
                                FontSize="14"
                                Foreground="DarkGray"
                                Text="ç”¨æ—¶" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":&#8202;" />
                            <Run
                                FontSize="14"
                                Foreground="#9DCBFF"
                                Text="{Binding ElapsedHours, Mode=OneWay, FallbackValue=0, StringFormat={}{0:D2}}" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":" />
                            <Run
                                FontSize="14"
                                Foreground="#9DCBFF"
                                Text="{Binding ElapsedMinutes, Mode=OneWay, FallbackValue=0, StringFormat={}{0:D2}}" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":" />
                            <Run
                                FontSize="14"
                                Foreground="#9DCBFF"
                                Text="{Binding ElapsedSeconds, Mode=OneWay, FallbackValue=0, StringFormat={}{0:D2}}" />
                        </TextBlock>

                        <!--  6) æµ‹è¯•è€…å§“å (existing binding preserved)  -->
                        <TextBlock
                            Grid.Column="5"
                            HorizontalAlignment="Center"
                            FontFamily="{StaticResource MenuFontFamily}"
                            FontSize="1">
                            <Run
                                FontSize="14"
                                Foreground="DarkGray"
                                Text="å§“å" />
                            <Run
                                FontFamily="{StaticResource MenuFontFamily}"
                                FontSize="14"
                                Foreground="DimGray"
                                Text=":&#8202;" />
                            <Run FontSize="14" Foreground="#4D8BCF">
                                <Run.Text>
                                    <Binding
                                        FallbackValue="æ±Ÿæ¹–äººå£«"
                                        Mode="OneWay"
                                        Path="TesterName"
                                        TargetNullValue="æ±Ÿæ¹–äººå£«" />
                                </Run.Text>
                            </Run>
                        </TextBlock>
                    </Grid>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>
