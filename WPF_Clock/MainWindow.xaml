<Window
    AllowsTransparency="True"
    Background="Transparent"
    Foreground="#FFFFFF"
    Height="600"
    MinHeight="530"
    MinWidth="400"
    Title="时钟"
    Width="800"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d"
    x:Class="WPF_Clock.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:WPF_Clock"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <!--  配置窗口样式以支持深色主题  -->
    <Window.Resources>
        <SolidColorBrush Color="#1A1A1A" x:Key="WindowBackgroundBrush" />
        <SolidColorBrush Color="#FFFFFF" x:Key="WindowTextBrush" />

        <!--  窗口按钮基础样式  -->
        <Style TargetType="Button" x:Key="WindowButtonStyle">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            Background="Transparent"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            x:Name="Border">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="#555" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="#777" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  关闭按钮样式 - 注意：右侧按钮需要特殊处理以不溢出窗口圆角  -->
        <Style TargetType="Button" x:Key="CloseButtonStyle">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <!--  为关闭按钮添加特殊的右侧圆角处理  -->
                        <Border
                            Background="Transparent"
                            CornerRadius="0,10,0,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            x:Name="Border">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="#E81123" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  自定义深色主题MenuItem样式  -->
        <Style TargetType="MenuItem" x:Key="DarkMenuItemStyle">
            <Setter Property="Background" Value="#1A1A1A" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="30" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border
                            Background="#1A1A1A"
                            BorderBrush="Transparent"
                            BorderThickness="1"
                            Height="30"
                            x:Name="Border">
                            <Grid>
                                <ContentPresenter
                                    ContentSource="Header"
                                    Margin="10,0"
                                    VerticalAlignment="Center"
                                    x:Name="HeaderHost" />
                                <Popup
                                    AllowsTransparency="True"
                                    HorizontalOffset="-2"
                                    IsOpen="{TemplateBinding IsSubmenuOpen}"
                                    Placement="Bottom"
                                    VerticalOffset="5"
                                    x:Name="SubMenuPopup">
                                    <Border
                                        Background="#2D2D2D"
                                        BorderBrush="#2D2D2D"
                                        BorderThickness="1"
                                        x:Name="SubMenuBorder">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="#135" />
                                <Setter Property="BorderBrush" TargetName="Border" Value="#2DB" />
                                <Setter Property="BorderThickness" TargetName="Border" Value="1" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  自定义深色主题子MenuItem样式（不带勾选框）  -->
        <Style TargetType="MenuItem" x:Key="DarkSubMenuItemStyle">
            <Setter Property="Background" Value="#2D2D2D" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="30" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border
                            Background="#2D2D2D"
                            BorderBrush="#444"
                            BorderThickness="1"
                            Height="30"
                            x:Name="Border">
                            <Grid>
                                <ContentPresenter
                                    ContentSource="Header"
                                    Margin="20,0"
                                    VerticalAlignment="Center"
                                    x:Name="HeaderHost" />
                                <Popup
                                    AllowsTransparency="True"
                                    IsOpen="{TemplateBinding IsSubmenuOpen}"
                                    Placement="Right"
                                    x:Name="SubMenuPopup">
                                    <Border
                                        Background="#2D2D2D"
                                        BorderBrush="#2D2D2D"
                                        BorderThickness="1"
                                        x:Name="SubMenuBorder">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="#345" />
                                <Setter Property="BorderBrush" TargetName="Border" Value="#4A90E2" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  带勾选框的子MenuItem样式（专用于"显示时钟"）  -->
        <Style TargetType="MenuItem" x:Key="CheckableSubMenuItemStyle">
            <Setter Property="Background" Value="#2D2D2D" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="30" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border
                            Background="#2D2D2D"
                            BorderBrush="#444"
                            BorderThickness="1"
                            Height="30"
                            x:Name="Border">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <!--  勾选标记容器 - 始终显示方框  -->
                                <Border
                                    Background="Transparent"
                                    BorderBrush="Gray"
                                    BorderThickness="1"
                                    Grid.Column="0"
                                    Height="14"
                                    Margin="10,0,0,0"
                                    VerticalAlignment="Center"
                                    Width="14"
                                    x:Name="CheckMarkBox">
                                    <!--  勾选标记 - 只有选中时才显示  -->
                                    <TextBlock
                                        FontSize="10"
                                        Foreground="White"
                                        HorizontalAlignment="Center"
                                        Text="✓"
                                        VerticalAlignment="Center"
                                        Visibility="Collapsed"
                                        x:Name="CheckMark" />
                                </Border>
                                <ContentPresenter
                                    ContentSource="Header"
                                    Grid.Column="1"
                                    Margin="10,0"
                                    VerticalAlignment="Center"
                                    x:Name="HeaderHost" />
                                <Popup
                                    AllowsTransparency="True"
                                    IsOpen="{TemplateBinding IsSubmenuOpen}"
                                    Placement="Right"
                                    x:Name="SubMenuPopup">
                                    <Border
                                        Background="#2D2D2D"
                                        BorderBrush="#2D2D2D"
                                        BorderThickness="1"
                                        x:Name="SubMenuBorder">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle" />
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="#345" />
                                <Setter Property="BorderBrush" TargetName="Border" Value="#4A90E2" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Visibility" TargetName="CheckMark" Value="Visible" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!--  配置WindowChrome以支持拖动和调整大小  -->
    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="0"
            CornerRadius="10"
            GlassFrameThickness="0"
            IsHitTestVisibleInChrome="True"
            ResizeBorderThickness="5"
            UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>
    <!--  使用Border作为根元素以实现完整的圆角边框  -->
    <Border
        Background="#1A1A1A"
        BorderBrush="#555"
        BorderThickness="1"
        CornerRadius="10">
        <Grid>
            <!--  自定义标题栏 - 完全替换系统标题栏  -->
            <Grid
                Height="30"
                MouseLeftButtonDown="WindowTitleBar_MouseLeftButtonDown"
                Panel.ZIndex="10"
                VerticalAlignment="Top">
                <!--  使用Border来实现标题栏，并设置圆角  -->
                <Border Background="#2D2D2D" CornerRadius="10,10,0,0">
                    <!--  使用Grid作为容器，让标题文本和按钮共存  -->
                    <Grid>
                        <TextBlock
                            FontSize="14"
                            Foreground="#CCC"
                            HorizontalAlignment="Center"
                            Panel.ZIndex="5"
                            Text="时钟"
                            VerticalAlignment="Center" />

                        <!--  标题栏按钮 - 设置较高z-index确保可点击  -->
                        <StackPanel
                            HorizontalAlignment="Right"
                            Orientation="Horizontal"
                            Panel.ZIndex="10"
                            VerticalAlignment="Top">
                            <!--  最小化按钮  -->
                            <Button
                                Click="MinimizeButton_Click"
                                Content="−"
                                Focusable="True"
                                FontFamily="Google Sans Code, Consolas"
                                FontSize="16"
                                Height="30"
                                Panel.ZIndex="20"
                                Style="{StaticResource WindowButtonStyle}"
                                Width="30"
                                x:Name="MinimizeButton" />

                            <!--  最大化按钮  -->
                            <Button
                                Click="MaximizeButton_Click"
                                Content="□"
                                Focusable="True"
                                FontFamily="Google Sans Code, Consolas"
                                FontSize="16"
                                Height="30"
                                Panel.ZIndex="20"
                                Style="{StaticResource WindowButtonStyle}"
                                Width="30"
                                x:Name="MaximizeButton" />

                            <!--  关闭按钮  -->
                            <Button
                                Click="CloseButton_Click"
                                Content="✕"
                                Focusable="True"
                                FontFamily="Google Sans Code, Consolas"
                                FontSize="16"
                                Height="30"
                                Panel.ZIndex="20"
                                Style="{StaticResource CloseButtonStyle}"
                                Width="30"
                                x:Name="CloseButton" />
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!--  菜单栏  -->
            <Menu
                Background="#1A1A1A"
                BorderBrush="#30FFFFFF"
                BorderThickness="0,0,0,1"
                Foreground="White"
                Height="30"
                HorizontalAlignment="Stretch"
                Margin="0,30,0,0"
                Padding="5,0"
                Panel.ZIndex="10"
                VerticalAlignment="Top"
                Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=Window}}">
                <!--  文件菜单  -->
                <MenuItem Header="文件" Style="{StaticResource DarkMenuItemStyle}">
                    <MenuItem
                        Click="ExitMenuItem_Click"
                        Header="退出"
                        Style="{StaticResource DarkSubMenuItemStyle}" />
                </MenuItem>
                <!--  设置菜单  -->
                <MenuItem Header="设置" Style="{StaticResource DarkMenuItemStyle}">
                    <MenuItem
                        Click="ShowClockMenuItem_Click"
                        Header="显示时钟"
                        IsCheckable="True"
                        IsChecked="True"
                        Style="{StaticResource CheckableSubMenuItemStyle}"
                        x:Name="ShowClockMenuItem" />
                </MenuItem>
                <!--  关于菜单  -->
                <MenuItem Header="关于" Style="{StaticResource DarkMenuItemStyle}">
                    <MenuItem
                        Click="AboutMenuItem_Click"
                        Header="应用信息"
                        Style="{StaticResource DarkSubMenuItemStyle}" />
                </MenuItem>
            </Menu>

            <!--  内容区域 - 整体垂直居中  -->
            <Grid Margin="0,60,0,0">
                <!--  使用StackPanel将日期、时间和时钟作为一个整体垂直居中  -->
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!--  日期显示  -->
                    <StackPanel
                        HorizontalAlignment="Center"
                        Margin="0,0,0,10"
                        Orientation="Horizontal">
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="24"
                            FontWeight="Normal"
                            Foreground="LightCyan"
                            x:Name="YearText" />
                        <TextBlock
                            FontFamily="HarmonyOS Sans SC, 微软雅黑"
                            FontSize="22"
                            FontWeight="Normal"
                            Foreground="#789"
                            Margin="3,0"
                            Text="年" />
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="24"
                            FontWeight="Normal"
                            Foreground="LightCyan"
                            x:Name="MonthText" />
                        <TextBlock
                            FontFamily="HarmonyOS Sans SC, 微软雅黑"
                            FontSize="22"
                            FontWeight="Normal"
                            Foreground="#789"
                            Margin="3,0"
                            Text="月" />
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="24"
                            FontWeight="Normal"
                            Foreground="LightCyan"
                            x:Name="DayText" />
                        <TextBlock
                            FontFamily="HarmonyOS Sans SC, 微软雅黑"
                            FontSize="22"
                            FontWeight="Normal"
                            Foreground="#789"
                            Margin="3,0"
                            Text="日" />
                        <TextBlock
                            FontSize="24"
                            FontWeight="Normal"
                            Text="   " />
                        <TextBlock
                            FontFamily="HarmonyOS Sans SC, 微软雅黑"
                            FontSize="22"
                            FontWeight="Normal"
                            Foreground="#95E77E"
                            x:Name="WeekdayText" />
                    </StackPanel>

                    <!--  时间显示  -->
                    <StackPanel
                        HorizontalAlignment="Center"
                        Margin="0,0,0,20"
                        Orientation="Horizontal">
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="48"
                            FontWeight="Normal"
                            Foreground="LightSkyBlue"
                            x:Name="HourText" />
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="32"
                            FontWeight="Normal"
                            Foreground="Gray"
                            Margin="5,0"
                            Text=":"
                            VerticalAlignment="Center" />
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="48"
                            FontWeight="Normal"
                            Foreground="LightSkyBlue"
                            x:Name="MinuteText" />
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="32"
                            FontWeight="Normal"
                            Foreground="Gray"
                            Margin="5,0"
                            Text=":"
                            VerticalAlignment="Center" />
                        <TextBlock
                            FontFamily="Google Sans Code, Consolas"
                            FontSize="48"
                            FontWeight="Normal"
                            Foreground="LightSkyBlue"
                            x:Name="SecondText" />
                    </StackPanel>

                    <!--  时钟显示区域  -->
                    <Canvas
                        Background="Transparent"
                        Height="300"
                        HorizontalAlignment="Center"
                        Width="300"
                        x:Name="ClockCanvas">
                        <!--  时钟外圈  -->
                        <Ellipse
                            Fill="#2D2D2D"
                            Height="300"
                            Stroke="#AAA"
                            StrokeThickness="2"
                            Width="300" />

                        <!--  时钟刻度和数字将在代码中动态生成  -->

                        <!--  时针  -->
                        <Line
                            Stroke="#789"
                            StrokeEndLineCap="Round"
                            StrokeThickness="6"
                            x:Name="HourHand" />
                        <!--  分针  -->
                        <Line
                            Stroke="#DEF"
                            StrokeEndLineCap="Round"
                            StrokeThickness="4"
                            x:Name="MinuteHand" />
                        <!--  秒针  -->
                        <Line
                            Stroke="#FF4444"
                            StrokeEndLineCap="Round"
                            StrokeThickness="2"
                            x:Name="SecondHand" />
                        <!--  中心点  -->
                        <Ellipse
                            Fill="#FFFFFF"
                            Height="15"
                            Width="15"
                            x:Name="ClockCenter" />
                    </Canvas>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>